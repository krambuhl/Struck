!function(t,n){if("function"==typeof define&&define.amd)define(["lodash","jquery","exports"],function(e,o,i){t.Struck=n(t,i,e,o)});else if("undefined"!=typeof exports){var e=require("lodash"),o=require("jquery");exports=n(t,exports,e,o)}else t.Struck=n(t,{},t._,t.jQuery)}(this,function(t,n,e,o,i){function r(t){return t.charAt(0).toUpperCase()+t.slice(1)}function s(t,n){e.isUndefined(t)&&(t=this);var o=e.isFunction(n)?n.call(t):n;return e.isArray(o)?o:o.split(" ")}function c(t){return e.isFunction(t)?t():t}return n.Hook=function(){function t(t,n,e,o){t[n]&&t[n].call(t,e,o)}function n(n,i,r){var s=e.extend({},o,e.isFunction(i)?r:i);return function(){var o;return s.pre&&t(this,s.method,n,s.pre),e.isFunction(i)&&(o=i.apply(this,arguments)),t(this,s.method,n,s.prefix),s.post&&e.defer(t,this,s.method,n,s.post),o}}var o={prefix:"on",pre:"before",post:"after",method:"hook"};return n}(),n.Computed=function(){function t(){var t=e.extend({},n,opts);t=t}var n={};return t}(),n.extend=function(t,n){var o,i=this;o=t&&e.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},e.extend(o,i,n);var r=function(){this.constructor=o};return r.prototype=i.prototype,o.prototype=new r,t&&e.extend(o.prototype,t),o.__super__=i.prototype,o},n.BaseObject=function(){function t(t){this.baseInitiation(t),this.initialize()}function o(t,n){return e.reduce(n,function(n,e){return n[e]=t.get(e),n},{})}return t.prototype.initialize=n.Hook("initialize",e.noop),t.prototype.baseInitiation=n.Hook("baseInitiation",function(t){this.uid=e.uniqueId("struck"),this.options=e.extend({},t)}),t.prototype.destroy=n.Hook("destroy",e.noop),t.prototype.hook=function(t,n){var o=e.rest(arguments,2),i=n||"on",s=i+r(t);return this[s]?this[s].apply(this,o):void 0},t.prototype.get=n.Hook("get",function(t){var n=e.toArray(arguments);return e.isArray(t)?o(this,t):n.length>1?o(this,n):this[t]}),t.prototype.set=n.Hook("set",function(t,n){t=c(t),e.isObject(t)&&e.each(t,function(t,n){this.set(n,t)},this),this[t]=c(n)}),t.extend=n.extend,t.create=function(t,n){var o=this.extend(t);return new o(e.extend({},t,n))},t}(),n.EventObject=function(){"use strict";function t(t,n,e,i){i.once&&(e=function(){e.apply(t),o(t,n,e,i)}),this._events.push({events:n,func:e,obj:t})}function o(t,n,o){e.reject(this._events,{events:n,func:o,obj:t})}function r(e,o,i){e instanceof jQuery||e instanceof n.EventObject&&t(e,o,i)}function s(){}var c=n.BaseObject.extend({baseInitiation:function(){this.com=n.Intercom.create(),n.BaseObject.prototype.baseInitiation.apply(this,arguments),this._events=[]}});return c.prototype.hook=function(t,e){var o=e!==i?":"+e:"";n.BaseObject.prototype.hook.apply(this,arguments),this.com.emit(t+o,arguments)},c.prototype.listenTo=function(t,n,o,i){return r(t,n,o,e.extend({single:!1,args:args,context:this},i)),this},c.prototype.listenOnce=function(t,n,o,i){return r(t,n,o,e.extend({single:!0,args:args,context:this},i)),this},c.prototype.stopListening=function(t,n,e){return s(t,n,e),this},c.prototype.stopListeningAll=function(){return 0!==this._events.length?(e.each(this._events,function(t){s(t.obj,t.events,t.func)},this),this):void 0},c.prototype.destroy=function(){return n.BaseObject.prototype.destroy.apply(this,arguments),this.stopListeningAll(),e.defer(function(t){t.com.destroy(),delete t.com},this),this},c}(),n.Intercom=function(t){function o(t,n,o,i){e.each(s(t,n),function(n){r(t,n,o,{single:i.single,context:i.context,args:i.args})})}function r(t,n,o,i){if(n||o){var r={name:n,callback:o};e.each(f,function(t){i[t]&&(r[t]=i[t])});var s=e.extend({},p,r);t.subscriptions.push(s)}}function c(t,n,o){return n===i||"all"===n?void u(t):void e.each(s(t,n),function(n){u(t,n,o)})}function u(t,n,o){var i=function(t){return o?t.name==n&&t.callback==o:n?t.name==n:!0};t.subscriptions=e.reject(t.subscriptions,i)}function a(t,n,e){n.callback.apply(n.context,e?[e].concat(n.args):n.args),n.single&&u(t,n.name,n.callback)}var p={single:!1,name:"all",callback:e.noop,context:t,args:[]},f=e.keys(p),h=n.BaseObject.extend({baseInitiation:function(){n.BaseObject.prototype.baseInitiation.apply(this,arguments),this.defaultSubscription=e.extend(e.clone(p),{context:this}),this.subscriptions=[]}});return h.prototype.on=function(t,n,i){return o(this,t,n,{single:!1,context:i,args:e.rest(arguments,3)}),this},h.prototype.once=function(t,n,i){return o(this,t,n,{single:!0,context:i,args:e.rest(arguments,3)}),this},h.prototype.off=function(t,n){return c(this,t,n),this},h.prototype.emit=function(t,n){var o=e.reduce(s(this,t),function(t,n){var o=e.filter(this.subscriptions,function(t){return t.name==n},this);return t.concat(o)},[],this);return o=e.unique(o),e.each(o,function(t){a(this,t,n)},this),this},h}(t),n});
//# sourceMappingURL=struck.min.js.map