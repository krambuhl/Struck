!function(t,n){if("function"==typeof define&&define.amd)define(["lodash","jquery","exports"],function(e,o,i){t.Struck=n(t,i,e,o)});else if("undefined"!=typeof exports){var e=require("lodash"),o=require("jquery");exports=n(t,exports,e,o)}else t.Struck=n(t,{},t._,t.jQuery)}(this,function(t,n,e,o,i){function r(t){return t.charAt(0).toUpperCase()+t.slice(1)}function s(t,n){e.isUndefined(t)&&(t=this);var o=e.isFunction(n)?n.call(t):n;return e.isArray(o)?o:o.split(" ")}function c(t){return e.isFunction(t)?t():t}return n.Hook=function(){function t(t,n,e,o){t[n]&&t[n].call(t,e,o)}function n(n,i,r){var s=e.extend({},o,e.isFunction(i)?r:i);return function(){var o;return s.pre&&t(this,s.method,n,s.pre),e.isFunction(i)&&(o=i.apply(this,arguments)),t(this,s.method,n,s.prefix),s.post&&e.defer(t,this,s.method,n,s.post),o}}var o={prefix:"on",pre:"before",post:"after",method:"hook"};return n}(),n.Computed=function(){function t(){var t=e.extend({},n,opts);t=t}var n={};return t}(),n.extend=function(t,n){var o,i=this;o=t&&e.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},e.extend(o,i,n);var r=function(){this.constructor=o};return r.prototype=i.prototype,o.prototype=new r,t&&e.extend(o.prototype,t),o.__super__=i.prototype,o},n.BaseObject=function(){function t(t){this.baseInitiation(t),this.initialize()}function o(t,n){return e.reduce(n,function(n,e){return n[e]=t.get(e),n},{})}return t.prototype.initialize=n.Hook("initialize",e.noop),t.prototype.baseInitiation=n.Hook("baseInitiation",function(t){this.uid=e.uniqueId("struck"),this.options=e.extend({},t)}),t.prototype.destroy=n.Hook("destroy",e.noop),t.prototype.hook=function(t,n){var o=e.rest(arguments,2),i=n||"on",s=i+r(t);return this[s]?this[s].apply(this,o):void 0},t.prototype.get=n.Hook("get",function(t){var n=e.toArray(arguments);return e.isArray(t)?o(this,t):n.length>1?o(this,n):this[t]}),t.prototype.set=n.Hook("set",function(t,n){t=c(t),e.isObject(t)&&e.each(t,function(t,n){this.set(n,t)},this),this[t]=c(n)}),t.extend=n.extend,t.create=function(t,n){var o=this.extend(t);return new o(e.extend({},t,n))},t}(),n.EventObject=function(){"use strict";function t(t,i,r,s,u){var a="on",p=s;u.single&&(a="once",p=function(){s.apply(this,arguments),o(t,i,r,p)}),r=c(r),r&&!e.isArray(r)&&(r=r.split(" ")),e.each(r,function(e){if(t._events.push({events:e,func:p,obj:i}),i instanceof jQuery)i[a](e,s);else if(i instanceof n.EventObject){var o=[e,p,u.context].concat(u.args);i.com[a].apply(i.com,o)}})}function o(t,o,i,r){i=c(i),i&&!e.isArray(i)&&(i=i.split(" "));var s=[],u=[];r?e.each(i,function(n){e.each(t._events,function(t){var e=t.obj==o&&t.events==n&&t.func==r;e?s.push(t):u.push(t)})}):i?e.each(i,function(n){e.each(t._events,function(t){var e=t.obj==o&&t.events==n;e?s.push(t):u.push(t)})}):o?e.each(t._events,function(t){var n=t.obj==o;n?s.push(t):u.push(t)}):s=t._events,t._events=u,e.each(s,function(t){t.obj instanceof jQuery?t.obj.off(t.events,t.func):t.obj instanceof n.EventObject&&t.obj.com.off(t.events,s.func)})}var r=n.BaseObject.extend({baseInitiation:function(){this.com=n.Intercom.create(),n.BaseObject.prototype.baseInitiation.apply(this,arguments),this._events=[]}});return r.prototype.hook=function(t,e){var o=e!==i&&"on"!==e?":"+e:"";n.BaseObject.prototype.hook.apply(this,arguments),this.com.emit(t+o,arguments)},r.prototype.listenTo=function(n,o,i,r){var s=e.rest(arguments,4);return t(this,n,o,i,{single:!1,args:s,context:r||this}),this},r.prototype.listenOnce=function(n,o,i,r){var s=e.rest(arguments,4);return t(this,n,o,i,{single:!0,args:s,context:r||this}),this},r.prototype.stopListening=function(t,n,e){return o(this,t,n,e),this},r.prototype.destroy=function(){return n.BaseObject.prototype.destroy.apply(this,arguments),this.stopListening(),e.defer(function(t){t.com.destroy(),delete t.com},this),this},r}(),n.Intercom=function(t){function o(t,n,o,i){e.each(s(t,n),function(n){r(t,n,o,{single:i.single,context:i.context,args:i.args})})}function r(t,n,o,i){if(n||o){var r={name:n,callback:o};e.each(f,function(t){i[t]&&(r[t]=i[t])});var s=e.extend({},p,r);t.subscriptions.push(s)}}function c(t,n,o){return n===i||"all"===n?void u(t):void e.each(s(t,n),function(n){u(t,n,o)})}function u(t,n,o){var i=function(t){return o?t.name==n&&t.callback==o:n?t.name==n:!0};t.subscriptions=e.reject(t.subscriptions,i)}function a(t,n,e){n.callback.apply(n.context,e?[e].concat(n.args):n.args),n.single&&u(t,n.name,n.callback)}var p={single:!1,name:"all",callback:e.noop,context:t,args:[]},f=e.keys(p),h=n.BaseObject.extend({baseInitiation:function(){n.BaseObject.prototype.baseInitiation.apply(this,arguments),this.defaultSubscription=e.extend(e.clone(p),{context:this}),this.subscriptions=[]}});return h.prototype.on=function(t,n,i){return o(this,t,n,{single:!1,context:i,args:e.rest(arguments,3)}),this},h.prototype.once=function(t,n,i){return o(this,t,n,{single:!0,context:i,args:e.rest(arguments,3)}),this},h.prototype.off=function(t,n){return c(this,t,n),this},h.prototype.emit=function(t,n){var o=e.reduce(s(this,t),function(t,n){var o=e.filter(this.subscriptions,function(t){return t.name==n},this);return t.concat(o)},[],this);return o=e.unique(o),e.each(o,function(t){a(this,t,n)},this),this},h}(t),n});
//# sourceMappingURL=struck.min.js.map