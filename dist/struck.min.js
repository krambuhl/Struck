!function(t,n){if("function"==typeof define&&define.amd)define(["lodash","jquery","exports"],function(e,o,i){t.Struck=n(t,i,e,o)});else if("undefined"!=typeof exports){var e=require("lodash"),o=require("jquery");exports=n(t,exports,e,o)}else t.Struck=n(t,{},t._,t.jQuery)}(this,function(t,n,e){function o(t){return t.charAt(0).toUpperCase()+t.slice(1)}function i(t,n){var o=r(t,n);return e.isArray(o)?o:o&&o.split(" ")}function r(t,n){return e.isFunction(t)?t.apply(n):t}function s(){return e.find(arguments,function(t){return!e.isUndefined(t)})}return n.hook=function(){function t(t,n,e,o){t[n]&&t[n].call(t,e,o)}function n(n,i,r){var s=e.extend({},o,e.isFunction(i)?r:i);return function(){var o;return s.pre&&t(this,s.method,n,s.pre),e.isFunction(i)&&(o=i.apply(this,arguments)),t(this,s.method,n,s.prefix),s.post&&e.defer(t,this,s.method,n,s.post),o}}var o={prefix:"on",pre:"before",post:"after",method:"hook"};return n}(),n.computed=function(){function t(){var t=this;t.props=i(e.flatten(e.initial(arguments))),t.func=e.last(arguments);var o=e.once(n);return function(){return e.bind(o,void 0,t,this)(),t.cached||(t.cached=t.func.apply(this)),t.cached}}function n(t,n){e.each(t.props,function(e){n.listenTo("set:"+e,function(){t.cached=t.func.apply(n)})})}return t}(),n.extend=function(t,n){var o,i=this;o=t&&e.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},e.extend(o,i,n);var r=function(){this.constructor=o};return r.prototype=i.prototype,o.prototype=new r,t&&e.extend(o.prototype,t),o.__super__=i.prototype,o},n.BaseObject=function(){function t(t){this.baseConstructor(t),this.initialize()}function i(t,n){return e.reduce(n,function(n,e){return n[e]=t.get(e),n},{})}return t.prototype.baseConstructor=n.hook("baseConstructor",function(t){this.uid=e.uniqueId("uid"),this.options=e.extend({},t)}),t.prototype.initialize=n.hook("initialize",e.noop),t.prototype.destroy=n.hook("destroy",e.noop),t.prototype.hook=function(t,n){var i=e.rest(arguments,2),r=s(n,"on"),c=r+o(t);return this[c]?this[c].apply(this,i):void 0},t.prototype.get=n.hook("get",function(t){var n=e.toArray(arguments);return e.isArray(t)?i(this,t):n.length>1?i(this,n):r(this[t],this)}),t.prototype.set=n.hook("set",function(t,n){t=r(t),e.isObject(t)&&e.each(t,function(t,n){this.set(n,t)},this),this[t]=r(n,this)}),t.extend=n.extend,t.create=function(t,n){var o=this.extend(t);return new o(e.extend({},t,n))},t}(),n.EventObject=function(){"use strict";function t(t,r){var s=r.obj,c=i(r.events),u=r.func,a=r.single?function(){u.apply(this,arguments),o(t,s,r.events,a)}:u;e.each(c,function(e){t._events.push({events:e,func:a,obj:s}),s instanceof jQuery?s[r.single?"one":"on"](e,a):s instanceof n.EventObject&&s.com[r.single?"once":"on"].call(s.com,e,a,r.context)})}function o(t,o,r,s){function c(t,n){t?u.push(n):a.push(n)}r=i(r);var u=[],a=[];e.each(t._events,function(t){e.each(r,function(n){s?c(t.obj===o&&t.events===n&&t.func===s,t):r&&c(t.obj===o&&t.events===n,t)})}),r||s||!o?r||(u=t._events):e.each(t._events,function(t){c(t.obj===o,t)}),t._events=a,e.each(u,function(t){t.obj instanceof jQuery?t.obj.off(t.events,t.func):t.obj instanceof n.EventObject&&t.obj.com.off(t.events,u.func)})}var r=n.BaseObject.extend();return r.prototype.baseConstructor=function(){this.com=n.Intercom.create(),n.BaseObject.prototype.baseConstructor.apply(this,arguments),this._events=[]},r.prototype.hook=function(t,e){var o="";void 0!==e&&"on"!==e&&(o=":"+e),n.BaseObject.prototype.hook.apply(this,arguments),this.com.emit(t+o,arguments)},r.prototype.listenTo=function(n,o,i,r){var c=e.chain(arguments).rest(4).first().value();return t(this,{obj:n,events:o,func:i,single:s(c&&c.single,!1),context:s(r,this)}),this},r.prototype.listenOnce=function(t,n,e,o){return this.listenTo(t,n,e,s(o,this),{single:!0})},r.prototype.stopListening=function(t,n,e){return o(this,t,n,e),this},r.prototype.trigger=function(t){return this.com.emit.apply(this.com,[t].concat(e.rest(arguments,1))),this},r.prototype.destroy=function(){return n.BaseObject.prototype.destroy.apply(this,arguments),this.stopListening(),e.defer(function(t){t.com.destroy()},this),this},r}(),n.Intercom=function(){function o(t,n,o,s){e.each(i(n,t),function(n){r(t,n,o,{single:s.single,context:s.context})})}function r(t,n,o,i){if(n||o){var r={name:n,callback:o};e.each(f,function(t){i[t]&&(r[t]=i[t])});var s=e.extend({},p,r);t.subscriptions.push(s)}}function c(t,n,o){return void 0===n?void u(t):void e.each(i(n,t),function(n){u(t,n,o)})}function u(t,n,o){var i=function(t){return o?t.name===n&&t.callback===o:n?t.name===n:!0};t.subscriptions=e.reject(t.subscriptions,i)}function a(t,n,e){n.callback.apply(n.context,e),n.single&&u(t,n.name,n.callback)}var p={single:!1,name:"all",callback:e.noop,context:t},f=e.keys(p),h=n.BaseObject.extend();return h.prototype.baseConstructor=function(){n.BaseObject.prototype.baseConstructor.apply(this,arguments),this.defaultSubscription=e.extend({},p,{context:this}),this.subscriptions=[]},h.prototype.on=function(t,n,e,i){return o(this,t,n,{single:s(i&&i.single,!1),context:e}),this},h.prototype.once=function(t,n,e){return this.on(t,n,e,{single:!0})},h.prototype.off=function(t,n){return c(this,t,n),this},h.prototype.emit=function(t){var n=e.rest(arguments,1),o=e.reduce(i(t,this),function(t,n){var o=e.filter(this.subscriptions,function(t){return t.name===n},this);return t.concat(o)},[],this);return o=e.unique(o),e.each(o,function(t){a(this,t,n)},this),this},h}(),n});
//# sourceMappingURL=struck.min.js.map